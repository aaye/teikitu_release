/* =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- */
/*  »Project«   Teikitu Gaming System (TgS) (∂)
    »File«      TgS (X86_64) Common - Math [Matrix] [F] [34].inl
    »Author«    Andrew Aye (mailto: teikitu@andrewaye.com, https://www.andrew.aye.page)
    »Version«   5.16 | »GUID« 015482FC-A4BD-4E1C-AE49-A30E5728D73A */
/*  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
/*  Copyright: © 2002-2023, Andrew Aye.  All Rights Reserved.
    This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. To view a copy of this license,
    visit http://creativecommons.org/licenses/by-nc-sa/4.0/ or send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA. */
/* =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- */
#if !defined(TGS_COMMON_MATH_API_MATRIX_F_34_INL)
#define TGS_COMMON_MATH_API_MATRIX_F_34_INL
#pragma once


/* == Common ===================================================================================================================================================================== */

/* -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.- */
/*  Public Functions                                                                                                                                                               */
/* -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.- */

/* ---- tgMH_CLR_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_CLR_F32_04_3( TgVEC_F32_04_3_PCU pmM0 )
{
    tgMM_Set_U08_0x00( pmM0, sizeof( TgVEC_F32_04_3 ) );
}


/* ---- tgMH_Init_T_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_Init_T_F32_04_3( TgVEC_F32_04_3_PCU pmM0, TgVEC_F32_04_1_C vS0 )
{
    const __m128                        mi00 = _mm_and_ps( KTgFFF0_V128.m_vF32_04_1, vS0 );
    const __m128                        mi01 = _mm_shuffle_ps( KTgZERO_V128.m_vF32_04_1, mi00, MM_PERM( 0, 0, 3, 0 ) );
    const __m128                        mi02 = _mm_shuffle_ps( KTgZERO_V128.m_vF32_04_1, mi00, MM_PERM( 0, 0, 3, 1 ) );
    const __m128                        mi03 = _mm_shuffle_ps( KTgZERO_V128.m_vF32_04_1, mi00, MM_PERM( 0, 0, 3, 2 ) );

    pmM0->m_avCol[0] = _mm_add_ps( KTgUNIT_X_V128.m_vF32_04_1, mi01 );
    pmM0->m_avCol[1] = _mm_add_ps( KTgUNIT_Y_V128.m_vF32_04_1, mi02 );
    pmM0->m_avCol[2] = _mm_add_ps( KTgUNIT_Z_V128.m_vF32_04_1, mi03 );
}


/* ---- tgMH_Init_Quat_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_Init_Quat_F32_04_3( TgVEC_F32_04_3_PCU pmM0, TgVEC_F32_04_1_C qR0 )
{
    TgUN_PTR_V128                       uM0;
    TgUN_CONST_PTR_V128                 uV0;

    uM0.m_pvF32_04_3 = pmM0;
    uV0.m_pvF32_04_1 = &qR0;
    tgMH_Init_Quat_S_F32_04_3( uM0.m_pvS_F32_04_3, *uV0.m_pvS_F32_04_1 );
}


/* ---- tgMH_CLI_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_CLI_F32_04_3( TgVEC_F32_04_3_PCU pmM0 )
{
    pmM0->m_avCol[0] = KTgUNIT_X_V128.m_vF32_04_1;
    pmM0->m_avCol[1] = KTgUNIT_Y_V128.m_vF32_04_1;
    pmM0->m_avCol[2] = KTgUNIT_Z_V128.m_vF32_04_1;
}


/* ---- tgMH_Set_T_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_Set_T_F32_04_3( TgVEC_F32_04_3_PCU pmM0, TgVEC_F32_04_1_C vS0 )
{
    const __m128                        mi00 = _mm_and_ps( KTgFFF0_V128.m_vF32_04_1, pmM0->m_avCol[0] );
    const __m128                        mi01 = _mm_and_ps( KTgFFF0_V128.m_vF32_04_1, pmM0->m_avCol[1] );
    const __m128                        mi02 = _mm_and_ps( KTgFFF0_V128.m_vF32_04_1, pmM0->m_avCol[2] );
    const __m128                        mi03 = _mm_and_ps( KTgFFF0_V128.m_vF32_04_1, vS0 );

    const __m128                        mi04 = _mm_shuffle_ps( KTgZERO_V128.m_vF32_04_1, mi03, MM_PERM( 0, 0, 3, 0 ) );
    const __m128                        mi05 = _mm_shuffle_ps( KTgZERO_V128.m_vF32_04_1, mi03, MM_PERM( 0, 0, 3, 1 ) );
    const __m128                        mi06 = _mm_shuffle_ps( KTgZERO_V128.m_vF32_04_1, mi03, MM_PERM( 0, 0, 3, 2 ) );

    pmM0->m_avCol[0] = _mm_add_ps( mi00, mi04 );
    pmM0->m_avCol[1] = _mm_add_ps( mi01, mi05 );
    pmM0->m_avCol[2] = _mm_add_ps( mi02, mi06 );
}


/* ---- tgMH_Set_Quat_F32_04_3 --------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_Set_Quat_F32_04_3( TgVEC_F32_04_3_PCU pmM0, TgVEC_F32_04_1_C qR0 )
{
    TgUN_PTR_V128                       uM0;
    TgUN_CONST_PTR_V128                 uV0;

    uM0.m_pvF32_04_3 = pmM0;
    uV0.m_pvF32_04_1 = &qR0;
    tgMH_Set_Quat_S_F32_04_3( uM0.m_pvS_F32_04_3, *uV0.m_pvS_F32_04_1 );
}


/* ---- tgMH_MAX_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_MAX_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_MAX_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_MAX_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_MAX_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_MIN_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_MIN_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_MIN_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_MIN_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_MIN_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_AND_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_AND_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_AND_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_AND_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_AND_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_OR_F32_04_3 --------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_OR_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_OR_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_OR_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_OR_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_XOR_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_XOR_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_XOR_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_XOR_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_XOR_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_ADD_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_ADD_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_ADD_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_ADD_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_ADD_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_MUL_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_MUL_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_MUL_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_MUL_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_MUL_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_MUL_SM_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_MUL_SM_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgFLOAT32_C fS, TgVEC_F32_04_3_CPCU pmM1 )
{
    TgVEC_F32_04_1                    vS;

    vS = tgMH_SET1_F32_04_1( fS );

    pmOut->m_avCol[0] = tgMH_MUL_F32_04_1( vS, pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_MUL_F32_04_1( vS, pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_MUL_F32_04_1( vS, pmM1->m_avCol[2] );
}


/* ---- tgMH_MUL_MS_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_MUL_MS_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgFLOAT32_C fS )
{
    TgVEC_F32_04_1                    vS;

    vS = tgMH_SET1_F32_04_1( fS );

    pmOut->m_avCol[0] = tgMH_MUL_F32_04_1( pmM0->m_avCol[0], vS );
    pmOut->m_avCol[1] = tgMH_MUL_F32_04_1( pmM0->m_avCol[1], vS );
    pmOut->m_avCol[2] = tgMH_MUL_F32_04_1( pmM0->m_avCol[2], vS );
}


/* ---- tgMH_DIV_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_DIV_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_DIV_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_DIV_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_DIV_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_DIV_SM_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_DIV_SM_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgFLOAT32_C fS, TgVEC_F32_04_3_CPCU pmM1 )
{
    TgVEC_F32_04_1                    vS;

    vS = tgMH_SET1_F32_04_1( fS );

    pmOut->m_avCol[0] = tgMH_DIV_F32_04_1( vS, pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_DIV_F32_04_1( vS, pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_DIV_F32_04_1( vS, pmM1->m_avCol[2] );
}


/* ---- tgMH_DIV_MS_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_DIV_MS_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgFLOAT32_C fS )
{
    TgVEC_F32_04_1                    vS;

    vS = tgMH_SET1_F32_04_1( fS );

    pmOut->m_avCol[0] = tgMH_DIV_F32_04_1( pmM0->m_avCol[0], vS );
    pmOut->m_avCol[1] = tgMH_DIV_F32_04_1( pmM0->m_avCol[1], vS );
    pmOut->m_avCol[2] = tgMH_DIV_F32_04_1( pmM0->m_avCol[2], vS );
}


/* ---- tgMH_SUB_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_SUB_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    pmOut->m_avCol[0] = tgMH_SUB_F32_04_1( pmM0->m_avCol[0], pmM1->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_SUB_F32_04_1( pmM0->m_avCol[1], pmM1->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_SUB_F32_04_1( pmM0->m_avCol[2], pmM1->m_avCol[2] );
}


/* ---- tgMH_NEG_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_NEG_F32_04_3( TgVEC_F32_04_3_PCU pmOut, TgVEC_F32_04_3_CPCU pmM0 )
{
    pmOut->m_avCol[0] = tgMH_NEG_F32_04_1( pmM0->m_avCol[0] );
    pmOut->m_avCol[1] = tgMH_NEG_F32_04_1( pmM0->m_avCol[1] );
    pmOut->m_avCol[2] = tgMH_NEG_F32_04_1( pmM0->m_avCol[2] );
}


/* ---- tgMH_CAT_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgEXTN TgVOID tgMH_CAT_F32_04_3_IMPL( TgVEC_F32_04_3_PCU, TgVEC_F32_04_3_CPCU, TgVEC_F32_04_3_CPCU );
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_CAT_F32_04_3( TgVEC_F32_04_3_PCU pmM0, TgVEC_F32_04_3_CPCU pmM1, TgVEC_F32_04_3_CPCU pmM2 )
{
    tgMH_CAT_F32_04_3_IMPL( pmM0, pmM1, pmM2 );
}


/* ---- tgMH_INV_DET_F32_04_3 ---------------------------------------------------------------------------------------------------------------------------------------------------- */
TgEXTN TgVOID tgMH_INV_DET_F32_04_3_IMPL( TgVEC_F32_04_4_PCU, TgFLOAT32_C, TgVEC_F32_04_3_CPCU );
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_INV_DET_F32_04_3( TgVEC_F32_04_4_PCU pmM0, TgFLOAT32_C fS, TgVEC_F32_04_3_CPCU pmM1 )
{
    tgMH_INV_DET_F32_04_3_IMPL( pmM0, fS, pmM1 );
}


/* ---- tgMH_INV_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_INV_F32_04_3( TgVEC_F32_04_4_PCU ptmRet, TgVEC_F32_04_3_CPCU pmM1 )
{
    tgMH_INV_DET_F32_04_3( ptmRet, tgMH_DET_F32_04_3( pmM1 ), pmM1 );
}


/* ---- tgMH_DET_F32_04_3 -------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgEXTN TgFLOAT32 tgMH_DET_F32_04_3_IMPL( TgVEC_F32_04_3_CPCU );
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgFLOAT32 tgMH_DET_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    return (tgMH_DET_F32_04_3_IMPL( pmM0 ));
}


/* ---- tgMH_TX_F32_04_3 --------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_TX_F32_04_3( TgVEC_F32_04_1_C vX0, TgVEC_F32_04_3_CPCU pmM0 )
{
     /*  Probably a much better/faster way to do this, but I got bored. */

    const __m128                        miXMM0 = _mm_unpacklo_ps( pmM0->m_avCol[0], pmM0->m_avCol[1] );
    const __m128                        miXMM1 = _mm_unpacklo_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1 );
    const __m128                        miXMM2 = _mm_unpackhi_ps( pmM0->m_avCol[0], pmM0->m_avCol[1] );
    const __m128                        miXMM3 = _mm_unpackhi_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1 );
    const __m128                        miXMM4 = _mm_movelh_ps( miXMM0, miXMM1 );
    const __m128                        miXMM5 = _mm_movehl_ps( miXMM1, miXMM0 );
    const __m128                        miXMM6 = _mm_movelh_ps( miXMM2, miXMM3 );
    const __m128                        miXMM7 = _mm_movehl_ps( miXMM3, miXMM2 );
    const __m128                        miXMM8 = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0x00 ), miXMM4 );
    const __m128                        miXMM9 = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0x55 ), miXMM5 );
    const __m128                        miXMMA = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0xAA ), miXMM6 );
    const __m128                        miXMMB = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0xFF ), miXMM7 );

    return (_mm_add_ps( _mm_add_ps( miXMM8, miXMM9 ), _mm_add_ps( miXMMA, miXMMB ) ));
}


/* ---- tgMH_TX_P_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_TX_P_F32_04_3( TgVEC_F32_04_1_C vX0, TgVEC_F32_04_3_CPCU pmM0 )
{
    /* Probably a much better/faster way to do this, but I got bored. */

    const __m128                        miXMM0 = _mm_unpacklo_ps( pmM0->m_avCol[0], pmM0->m_avCol[1] );
    const __m128                        miXMM1 = _mm_unpacklo_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1 );
    const __m128                        miXMM2 = _mm_unpackhi_ps( pmM0->m_avCol[0], pmM0->m_avCol[1] );
    const __m128                        miXMM3 = _mm_unpackhi_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1 );
    const __m128                        miXMM4 = _mm_movelh_ps( miXMM0, miXMM1 );
    const __m128                        miXMM5 = _mm_movehl_ps( miXMM1, miXMM0 );
    const __m128                        miXMM6 = _mm_movelh_ps( miXMM2, miXMM3 );
    const __m128                        miXMM7 = _mm_movehl_ps( miXMM3, miXMM2 );
    const __m128                        miXMM8 = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0x00 ), miXMM4 );
    const __m128                        miXMM9 = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0x55 ), miXMM5 );
    const __m128                        miXMMA = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0xAA ), miXMM6 );

    return (_mm_add_ps( _mm_add_ps( miXMM8, miXMM9 ), _mm_add_ps( miXMMA, miXMM7 ) ));
}


/* ---- tgMH_TX_V_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_TX_V_F32_04_3( TgVEC_F32_04_1_C vX0, TgVEC_F32_04_3_CPCU pmM0 )
{
    /* Probably a much better/faster way to do this, but I got bored. */

    const __m128                        miXMM0 = _mm_unpacklo_ps( pmM0->m_avCol[0], pmM0->m_avCol[1] );
    const __m128                        miXMM1 = _mm_unpacklo_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1 );
    const __m128                        miXMM2 = _mm_unpackhi_ps( pmM0->m_avCol[0], pmM0->m_avCol[1] );
    const __m128                        miXMM3 = _mm_unpackhi_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1 );
    const __m128                        miXMM4 = _mm_movelh_ps( miXMM0, miXMM1 );
    const __m128                        miXMM5 = _mm_movehl_ps( miXMM1, miXMM0 );
    const __m128                        miXMM6 = _mm_movelh_ps( miXMM2, miXMM3 );
    const __m128                        miXMM8 = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0x00 ), miXMM4 );
    const __m128                        miXMM9 = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0x55 ), miXMM5 );
    const __m128                        miXMMA = _mm_mul_ps( _mm_shuffle_ps( vX0, vX0, 0xAA ), miXMM6 );

    return (_mm_add_ps( _mm_add_ps( miXMM8, miXMM9 ), _mm_add_ps( miXMMA, KTgZERO_V128.m_vF32_04_1 ) ));
}


/* ---- tgMH_Query_Row_0_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Row_0_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM0 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0x44 );
    __m128                              miXMM1 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0x44 );

    return (_mm_shuffle_ps( miXMM0, miXMM1, 0x88 ));
}


/* ---- tgMH_Query_Row_1_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Row_1_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM0 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0x44 );
    __m128                              miXMM1 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0x44 );

    return (_mm_shuffle_ps( miXMM0, miXMM1, 0xDD ));
}


/* ---- tgMH_Query_Row_2_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Row_2_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM2 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0xEE );
    __m128                              miXMM3 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0xEE );

    return (_mm_shuffle_ps( miXMM2, miXMM3, 0x88 ));
}


/* ---- tgMH_Query_Row_3_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Row_3_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM2 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0xEE );
    __m128                              miXMM3 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0xEE );

    return (_mm_shuffle_ps( miXMM2, miXMM3, 0xDD ));
}


/* ---- tgMH_Query_Col_0_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Col_0_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    return (pmM0->m_avCol[0]);
}


/* ---- tgMH_Query_Col_1_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Col_1_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    return (pmM0->m_avCol[1]);
}


/* ---- tgMH_Query_Col_2_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Col_2_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    return (pmM0->m_avCol[2]);
}


/* ---- tgMH_Query_Col_3_F32_04_3 ------------------------------------------------------------------------------------------------------------------------------------------------ */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Col_3_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    return (KTgUNIT_W_V128.m_vF32_04_1);
}


/* ---- tgMH_Query_Axis_0_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Axis_0_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM0 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0x44 );
    __m128                              miXMM1 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0x44 );

    return (_mm_shuffle_ps( miXMM0, miXMM1, 0x88 ));
}


/* ---- tgMH_Query_Axis_1_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Axis_1_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM0 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0x44 );
    __m128                              miXMM1 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0x44 );

    return (_mm_shuffle_ps( miXMM0, miXMM1, 0xDD ));
}


/* ---- tgMH_Query_Axis_2_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Axis_2_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM2 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0xEE );
    __m128                              miXMM3 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0xEE );

    return (_mm_shuffle_ps( miXMM2, miXMM3, 0x88 ));
}


/* ---- tgMH_Query_Axis_3_F32_04_3 ----------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVEC_F32_04_1 tgMH_Query_Axis_3_F32_04_3( TgVEC_F32_04_3_CPCU pmM0 )
{
    __m128                              miXMM2 = _mm_shuffle_ps( pmM0->m_avCol[0], pmM0->m_avCol[1], 0xEE );
    __m128                              miXMM3 = _mm_shuffle_ps( pmM0->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0xEE );

    return (_mm_shuffle_ps( miXMM2, miXMM3, 0xDD ));
}


/* ---- tgMH_TR_F32_04_3 --------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
TgINLINE TgVOID tgMH_TR_F32_04_3( TgVEC_F32_04_4_PCU pmM0, TgVEC_F32_04_3_CPCU pmM1 )
{
    __m128                              miXMM0 = _mm_shuffle_ps( pmM1->m_avCol[0], pmM1->m_avCol[1], 0x44 );
    __m128                              miXMM2 = _mm_shuffle_ps( pmM1->m_avCol[0], pmM1->m_avCol[1], 0xEE );
    __m128                              miXMM1 = _mm_shuffle_ps( pmM1->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0x44 );
    __m128                              miXMM3 = _mm_shuffle_ps( pmM1->m_avCol[2], KTgUNIT_W_V128.m_vF32_04_1, 0xEE );

    pmM0->m_avCol[0] = _mm_shuffle_ps( miXMM0, miXMM1, 0x88 );
    pmM0->m_avCol[1] = _mm_shuffle_ps( miXMM0, miXMM1, 0xDD );
    pmM0->m_avCol[2] = _mm_shuffle_ps( miXMM2, miXMM3, 0x88 );
    pmM0->m_avCol[3] = _mm_shuffle_ps( miXMM2, miXMM3, 0xDD );
}


/* =============================================================================================================================================================================== */
#endif
